# Rulebook

## 🎯 ゲームの目的
謎の地下鉱脈に隠された宝石の配置を、仲間より早く完全に言い当てよう！
超音波を撃ち込み、反射して戻ってくる波の色と出口を手がかりに推理する、VR空間の宝石探しパズルゲームです。

---

## 🎲 セットアップ
### プレイヤー人数
- **1〜8人**でプレイ可能
- スタートプレイヤーはゲーム開始時に**自動的にランダムで決定**されます

### 盤面の構造
- **10×8マスのグリッド**：地下鉱脈を表す盤面（横10マス、縦8マス）
- **波の入口/出口**：グリッドの周囲から超音波を発射できます
  - **横方向（上下の辺）**：1〜10の番号（各辺10箇所）
  - **縦方向（左右の辺）**：A〜Hの文字（各辺8箇所）
  - 波は入口から発射され、同じ番号・文字の反対側、または角を曲がって別の辺から出てきます

### 宝石の配置ルール
#### 基本モード
- **宝石の総数**：**5個**（これが推理の目標です）
- **内訳**：
  - 🔴**赤の宝石**：1個
  - 🔵**青の宝石**：1個
  - 🟡**黄の宝石**：1個
  - ⚪**白の宝石**：2個
- **配置は完全ランダム**：ゲーム開始時に自動生成されます

#### 配置の制約
- 宝石同士は**辺で接触しない**（角で接することは可能）
- 宝石は**グリッド内に完全に収まる**配置
- 宝石が他の宝石に**完全に囲まれない**配置

#### 拡張モード（オプション）
ゲーム開始前に選択可能：

**🔷 ダイヤモンド拡張**
- ⚪白の宝石を1個、💎**透明な宝石**に置き換え
- 総数は**5個のまま**
- 透明な宝石：反射するが色は変えない

**⚫ 黒体拡張**
- 基本5個に加えて、⚫**黒い石を1個追加**
- 総数は**6個**になる
- 黒い石：波を完全に吸収し、出口に到達させない

### ログボード
- **VR内UIで自動表示**：全員が同じログボードを共有して見られます
- **自動記録**：波を撃つたびに、結果が自動的に記録されます
- **プレイヤーの操作は不要**：読み取り専用で、手動入力の必要はありません

---

## 🎮 プレイの流れ

### ターンの進行
プレイヤーは**時計回り**で順番に行動します。

### あなたのターンにできること
毎ターン、以下の**2つ**から1つを選びます：

#### 1. 超音波を発射する 🌊
##### 操作方法
- コントローラで入口（1〜10、A〜H）を指差し、トリガーで発射！

##### 波の動きの仕組み
超音波は**透明（白）な波**として発射され、まっすぐ進みます。

**宝石にぶつかったとき：**
- 波は宝石の辺に沿って**90°直角に反射**します
- 反射方向は、**波がぶつかった辺に対して垂直**に曲がります
  - 横から来た波は縦方向へ
  - 縦から来た波は横方向へ
- 宝石は**波を通過させません**。必ず反射します
- **透明な宝石**だけは例外で、波を反射させますが色は変えません

**黒い石にぶつかったとき（黒体拡張モード）：**
- 波は完全に**吸収**され、出口に到達しません
- ログには「×」マークが記録されます

##### 波の色の変化
超音波は、**反射した宝石の色を吸収**していきます。

**色の混合ルール：**
- 🔴**赤の宝石**に当たる → 波が赤色を吸収
- 🔵**青の宝石**に当たる → 波が青色を吸収
- 🟡**黄の宝石**に当たる → 波が黄色を吸収
- ⚪**透明な宝石**に当たる → 色は変わらない

**複数の宝石に当たった場合：**
- 🔴赤 + 🔵青 = 🟣紫
- 🔴赤 + 🟡黄 = 🟠オレンジ
- 🔵青 + 🟡黄 = 🟢緑
- 🔴赤 + 🔵青 + 🟡黄 = ⚫黒

**重要：** 波は経路上で**反射した全ての宝石の色を累積**します！

##### 結果の自動記録
波が出口に到達すると、以下の情報がログボードに自動追加されます：
- **入口ID**：どこから撃ったか（例：入口5、入口D）
- **出口ID**：どこから出てきたか（例：出口12、出口K）
- **最終的な色**：波が吸収した色（例：紫、オレンジ）
- **特殊フラグ**：吸収された場合は「×」マーク

#### 2. 特定の場所を調べる 🔍
- グリッドの特定座標（例：C-5）を選択
- その場所に宝石があるか、あれば何色かを確認できます
- **結果は全員に共有**されます（ログボードに記録）
- **使用制限**：1ゲーム中、**各プレイヤー3回まで**使用可能
- **戦略的に使おう**：最後の詰めや、迷ったときに温存した回数を使う

---

### ターン終了時にできること

#### 完全一致宣言 🏆
- 全ての宝石の位置と色がわかったら、**完全一致宣言ができます**

  1. VR内で宝石を配置し、答えを提出
  2. システムが自動判定
 
- ただし、ゲーム中に2回目まで。

---

## 🏆 勝利条件
**完全一致宣言**をして、**全5個の宝石の位置と色を配置していた**プレイヤーが勝利！

### 判定の詳細
- **正解**：全ての宝石（基本5個、黒体拡張なら6個）の位置と色が完全一致
- **不正解**：1個でも位置か色が間違っていたら失敗


---

## 💡 推理のコツ

### ログの読み方
推理の基本は**ログに記録された波のデータを分析すること**です。

#### パターン1：色の変化から宝石を特定
- **例1：透明な波が色付きで戻ってきた**
  - 入口5から撃つ → 赤色で出口12
  - → 経路上に**赤い宝石**がある！

- **例2：混合色から複数の宝石を推理**
  - 入口Aから撃つ → オレンジ色で出口H
  - オレンジ＝赤＋黄だから → 経路上に**赤と黄の宝石**がある！

#### パターン2：×マーク（吸収）から黒い石を確定
- 入口3から撃つ → ×（出口なし）
- → 経路上に**黒い石**がある（黒体拡張モード）
- この経路は宝石配置の候補から**即座に消去**できます

#### パターン3：出口の位置から反射点を逆算
- 入口5から撃つ → 出口Dから出てきた
- まっすぐ進むだけなら違う出口のはず → **途中で90°反射**している
- 複数の波のデータを重ねると、**曲がり角（宝石の位置）**が浮かび上がります

### 効果的な探索パターン

#### 消去法の活用 ❌
- 「ここには絶対ない」という情報も宝物
- 宝石が**ない場所**を特定することで、候補を絞り込む

## ⚡ ヒント

### 反射回数の推定 🔄
- **入口と出口の位置関係**から反射回数をある程度予測
  - 真向かいの出口 → 反射0回、または偶数回
  - 隣接する辺の出口 → 奇数回の反射
- 反射回数がわかれば、宝石の数も推測できる

### タイマープレッシャーの活用 ⏱️
- 90秒という制限が**思考を研ぎ澄まします**
- 焦らず、でも迷わず。直感も大切に
- 時間制限があるからこそ、完全一致宣言の瞬間がドラマチック！

---

**さあ、VR空間で宝石ハンターになろう！超音波を駆使して、隠された鉱脈の謎を解き明かせ！**
